@model GigUnite.Models.Gig

@{
	ViewData["Title"] = "Details";
	Layout = "~/Views/Shared/_Layout.cshtml";
}

<h1>Details for @Html.DisplayFor(model => model.Band) gig</h1>
<hr />

@*<div class="container">
		<div class="row">

		</div>
	</div>
*@
<div>
	<dl class="row">
		<dt class="col-sm-2">
			@Html.DisplayNameFor(model => model.Band)
		</dt>
		<dd class="col-sm-10">
			@Html.DisplayFor(model => model.Band)
		</dd>
		<dt class="col-sm-2">
			@Html.DisplayNameFor(model => model.Date)
		</dt>
		<dd class="col-sm-10">
			@Html.DisplayFor(model => model.Date)
		</dd>
		<dt class="col-sm-2">
			@Html.DisplayNameFor(model => model.Venue)
		</dt>
		<dd class="col-sm-10">
			<p id="location">@Html.DisplayFor(model => model.Venue)</p>
		</dd>
		<dt class="col-sm-2">
			@Html.DisplayNameFor(model => model.Price)
		</dt>
		<dd class="col-sm-10">
			@Html.DisplayFor(model => model.Price)
		</dd>
		<dt class="col-sm-2">
			Posted by
		</dt>
		<dd class="col-sm-10">
			<a class="nav-link text-dark" asp-area="" asp-controller="Profiles" asp-action="Details" asp-route-id="@Model.Profile.Displayname">@Html.DisplayFor(model => model.Profile.Displayname)</a>
		</dd>
	</dl>
</div>
<div class="col-xs-6 col-sm-6 col-md-4 col-lg-4">
	<p><b>Genres</b></p>
	@foreach (string genre in ViewBag.GigGenres)
	{
		<span class="tags">@genre</span>
	}
</div>

@for (var i = 0; i < ViewBag.Messages.Count; i++)
{
	<span>Posted by</span> @ViewBag.Profiles[i] <span> on </span> @ViewBag.TimesPosted[i]<br />
	<p>@ViewBag.Messages[i]</p><br />
}

<div class="row">
	<div class="col-md-4">
		<form asp-action="Details">
			<div class="form-group">
				<label>Comment:</label>
				<textarea name="message" id="message" class="form-control" rows="5"></textarea>
			</div>
			<div class="form-group">
				<input type="hidden" name="gigId" id="gigId" value=@Model.Id readonly />
			</div>
			<div class="form-group">
				<input type="submit" value="Add Comment" class="btn btn-primary" />
			</div>
		</form>
	</div>
</div>

<div id="map"></div>

<script>

	var map;

	function showMap() {
		var map = new google.maps.Map(document.getElementById('map'), {
			zoom: 8,
			center: { lat: 51.5074, lng: 0.1278 }
		});
		var geocoder = new google.maps.Geocoder();

		geocodeAddress(geocoder, map);
	}

	function geocodeAddress(geocoder, resultsMap) {
		var address = document.getElementById('location').innerHTML;
		geocoder.geocode({ 'address': address }, function (results, status) {
			if (status === 'OK') {
				resultsMap.setCenter(results[0].geometry.location);
				resultsMap.setZoom(10);
				var marker = new google.maps.Marker({
					map: resultsMap,
					position: results[0].geometry.location
				});
			}
		});
	}

</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDjXWcyMTwQFjJ5gaK2c3PzHRZOenKrTLA&libraries=places&callback=showMap" async defer></script>

<div>
	<a asp-action="Edit" asp-route-id="@Model.Id">Edit</a> |
	<a asp-action="Index">Back to List</a>
</div>